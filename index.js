const positionContainer = `<div id="overlap-manager-root" style="position: absolute; z-index: 150; top: 0px; left: 0px;"><div data-id="f0bbe881-704d-405d-ad09-a4d434db3e9c" style="position: fixed; z-index: 9;"><div data-outside-boundary-for="source-properties-editor"><div class="dialog-UExGRfA_ dialog-o2xKpnz8 dialog-nnDbXk_L rounded-nnDbXk_L shadowed-nnDbXk_L" tabindex="-1" style="z-index: 150; height: 696px; top: 0px; left: 0px; transform: translate(449px, 20px);"><div class="wrapper-o2xKpnz8" data-name="source-properties-editor" data-dialog-name="Long Position"><div class="container-HS2PTQRJ"><div data-dragg-area="true" class="title-HS2PTQRJ"><div class="ellipsis-HS2PTQRJ"><div class="titleWrap-xqf2SSG7"><span class="ellipsis-xqf2SSG7"> Long Position</span><span class="editIcon-xqf2SSG7" data-name="edit" data-role="button"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M17.086 6.207a2 2 0 0 1 2.828 0l1.879 1.879a2 2 0 0 1 0 2.828l-.94.94-9 9-1 1-.146.146H6v-4.707l.146-.146 1-1 9-9 .94-.94zm2.121.707a1 1 0 0 0-1.414 0l-.586.586 1.647 1.646 1.646 1.647.586-.586a1 1 0 0 0 0-1.414l-1.879-1.879zm.586 4.586L18.5 10.207 10.207 18.5l1.293 1.293 8.293-8.293zm-9 9l-1.647-1.646L7.5 17.207l-.5.5V21h3.293l.5-.5zm-2.586-4L9.5 17.793 17.793 9.5 16.5 8.207 8.207 16.5z"></path></svg></span><div class="empty-xqf2SSG7 hideEmpty-xqf2SSG7"></div></div><div class="hideInput-xqf2SSG7" data-disable-drag="true"><span class="container-Mtq7m9Yl intent-default-Mtq7m9Yl border-thin-Mtq7m9Yl size-medium-Mtq7m9Yl stretch-Mtq7m9Yl adjust-position-Mtq7m9Yl first-row-Mtq7m9Yl first-col-Mtq7m9Yl" tabindex="0"><span class="inner-slot-yJbunXPO inner-middle-slot-yJbunXPO"><input tabindex="-1" class="input-oiYdY6I4" value="Long Position"></span><span class="highlight-Mtq7m9Yl"></span></span></div></div></div><button class="close-HS2PTQRJ" data-name="close" type="button"><span class="icon-HS2PTQRJ" data-name="close" data-role="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 17" width="17" height="17" fill="currentColor"><path d="m.58 1.42.82-.82 15 15-.82.82z"></path><path d="m.58 15.58 15-15 .82.82-15 15z"></path></svg></span></button></div><div class="scrollWrap-Rf5MOAG5"><div class="headerBottomSeparator-Rf5MOAG5"></div><div class="wrapOverflow-qKQlcmkd"><div class="wrap-qKQlcmkd"><div class="scrollWrap-qKQlcmkd noScrollBar-qKQlcmkd"><div class="tabsWrap-Rf5MOAG5"><div class="tabs-Rf5MOAG5 tabs-g47ZTMzc"><div class="tab-Rf5MOAG5 tab-g47ZTMzc active-g47ZTMzc" data-type="tab-item" data-value="inputs" data-name="tab-item-inputs">Inputs</div><div class="tab-Rf5MOAG5 withHover-Rf5MOAG5 tab-g47ZTMzc" data-type="tab-item" data-value="style" data-name="tab-item-style">Style</div><div class="tab-Rf5MOAG5 withHover-Rf5MOAG5 tab-g47ZTMzc" data-type="tab-item" data-value="visibility" data-name="tab-item-visibility">Visibility</div><div class="slider-g47ZTMzc slider-n4RgAWzv" style="transform: translateX(6px); width: 72px; opacity: 1;"><div class="inner-n4RgAWzv"></div></div></div></div></div><div class="scrollLeft-qKQlcmkd"><div class="iconWrap-qKQlcmkd"><span class="icon-qKQlcmkd"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 10" width="20" height="10"><path fill="none" stroke="currentColor" stroke-width="1.5" d="M2 1l8 8 8-8"></path></svg></span></div></div><div class="scrollRight-qKQlcmkd"><div class="iconWrap-qKQlcmkd"><span class="icon-qKQlcmkd"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 10" width="20" height="10"><path fill="none" stroke="currentColor" stroke-width="1.5" d="M2 1l8 8 8-8"></path></svg></span></div></div></div></div></div><div class="scrollable-LHNfmvz1"><div class="content-mTbR5jYu"><div data-section-name="Risk/RewardlongAccountSize" class="cell-mTbR5jYu adaptive-mTbR5jYu checkableTitle-mTbR5jYu first-mTbR5jYu"><div class="inner-mTbR5jYu"><div class="wrap-CcYH2FIb"><span class="title-mzBlcrjf">Account size</span></div></div></div><div data-section-name="Risk/RewardlongAccountSize" class="cell-mTbR5jYu"><div class="inner-mTbR5jYu"><div class="wrap-CcYH2FIb"><div class="wrap-CcYH2FIb wrap-e3mVhuS7 breakpointNormal-e3mVhuS7"><span class="row-e3mVhuS7"><span class="container-Mtq7m9Yl intent-default-Mtq7m9Yl border-thin-Mtq7m9Yl size-medium-Mtq7m9Yl adjust-position-Mtq7m9Yl first-row-Mtq7m9Yl first-col-Mtq7m9Yl font-size-medium-Mtq7m9Yl input-fWFHuxA3" tabindex="0"><span class="inner-slot-yJbunXPO inner-middle-slot-yJbunXPO"><input aria-describedby="" data-property-id="Risk/RewardlongAccountSize" tabindex="-1" name="number-input" type="text" inputmode="numeric" class="input-oiYdY6I4 with-end-slot-oiYdY6I4" value="1000"></span><span class="inner-slot-yJbunXPO interactive-yJbunXPO"><div class="controlWrapper-I6SkDSuu"></div></span><span class="highlight-Mtq7m9Yl"></span></span></span></div></div></div></div><div data-section-name="Risk/RewardlongLotSize" class="cell-mTbR5jYu adaptive-mTbR5jYu checkableTitle-mTbR5jYu first-mTbR5jYu"><div class="inner-mTbR5jYu"><div class="wrap-CcYH2FIb"><span class="title-mzBlcrjf">Lot size</span></div></div></div><div data-section-name="Risk/RewardlongLotSize" class="cell-mTbR5jYu"><div class="inner-mTbR5jYu"><div class="wrap-CcYH2FIb"><div class="wrap-CcYH2FIb wrap-e3mVhuS7 breakpointNormal-e3mVhuS7"><span class="row-e3mVhuS7"><span class="container-Mtq7m9Yl intent-default-Mtq7m9Yl border-thin-Mtq7m9Yl size-medium-Mtq7m9Yl adjust-position-Mtq7m9Yl first-row-Mtq7m9Yl first-col-Mtq7m9Yl font-size-medium-Mtq7m9Yl input-fWFHuxA3" tabindex="0"><span class="inner-slot-yJbunXPO inner-middle-slot-yJbunXPO"><input aria-describedby="" data-property-id="Risk/RewardlongLotSize" tabindex="-1" name="number-input" type="text" inputmode="numeric" class="input-oiYdY6I4 with-end-slot-oiYdY6I4" value="1"></span><span class="inner-slot-yJbunXPO interactive-yJbunXPO"><div class="controlWrapper-I6SkDSuu"></div></span><span class="highlight-Mtq7m9Yl"></span></span></span></div></div></div></div><div data-section-name="Risk/RewardlongRisk" class="cell-mTbR5jYu adaptive-mTbR5jYu checkableTitle-mTbR5jYu first-mTbR5jYu"><div class="inner-mTbR5jYu"><div class="wrap-CcYH2FIb"><span class="title-mzBlcrjf">Risk</span></div></div></div><div data-section-name="Risk/RewardlongRisk" class="cell-mTbR5jYu"><div class="inner-mTbR5jYu"><div class="wrap-CcYH2FIb"><div class="wrap-CcYH2FIb wrap-e3mVhuS7 breakpointNormal-e3mVhuS7"><span class="row-e3mVhuS7"><span class="container-Mtq7m9Yl intent-default-Mtq7m9Yl border-thin-Mtq7m9Yl size-medium-Mtq7m9Yl adjust-position-Mtq7m9Yl first-row-Mtq7m9Yl first-col-Mtq7m9Yl font-size-medium-Mtq7m9Yl input-fWFHuxA3" tabindex="0"><span class="inner-slot-yJbunXPO inner-middle-slot-yJbunXPO"><input aria-describedby="" data-property-id="Risk/RewardlongRisk" tabindex="-1" name="number-input" type="text" inputmode="numeric" class="input-oiYdY6I4 with-end-slot-oiYdY6I4" value="10"></span><span class="inner-slot-yJbunXPO interactive-yJbunXPO"><div class="controlWrapper-I6SkDSuu"></div></span><span class="highlight-Mtq7m9Yl"></span></span></span><span class="row-e3mVhuS7"><span id="id_Risk/RewardlongRisk_unit-options-dropdown" role="button" class="container-Mtq7m9Yl intent-default-Mtq7m9Yl border-thin-Mtq7m9Yl size-medium-Mtq7m9Yl adjust-position-Mtq7m9Yl first-row-Mtq7m9Yl first-col-Mtq7m9Yl button-nCHoYtuE dropdown-fWFHuxA3" tabindex="0" data-name="unit-options-dropdown" data-role="listbox" aria-expanded="false" aria-disabled="false" aria-haspopup="listbox" aria-labelledby="id_Risk/RewardlongRisk_unit-options-dropdown"><span class="inner-slot-yJbunXPO inner-middle-slot-yJbunXPO"><span class="button-children-nCHoYtuE"><span>Cash</span></span></span><span class="inner-slot-yJbunXPO interactive-yJbunXPO"><span class="button-allnSfnt"><span class="icon-allnSfnt"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11 7" width="11" height="7" fill="none"><path stroke="currentColor" stroke-width="1.3" d="M.5 1.5l5 4 5-4"></path></svg></span></span></span><span class="highlight-Mtq7m9Yl"></span></span></span></div></div></div></div><div data-section-name="Risk/RewardlongEntryPrice" class="cell-mTbR5jYu adaptive-mTbR5jYu checkableTitle-mTbR5jYu first-mTbR5jYu"><div class="inner-mTbR5jYu"><div class="wrap-CcYH2FIb"><span class="title-mzBlcrjf">Entry price</span></div></div></div><div data-section-name="Risk/RewardlongEntryPrice" class="cell-mTbR5jYu"><div class="inner-mTbR5jYu"><div class="wrap-CcYH2FIb"><div class="wrap-CcYH2FIb wrap-e3mVhuS7 breakpointNormal-e3mVhuS7"><span class="row-e3mVhuS7"><span class="container-Mtq7m9Yl intent-default-Mtq7m9Yl border-thin-Mtq7m9Yl size-medium-Mtq7m9Yl adjust-position-Mtq7m9Yl first-row-Mtq7m9Yl first-col-Mtq7m9Yl font-size-medium-Mtq7m9Yl input-fWFHuxA3" tabindex="0"><span class="inner-slot-yJbunXPO inner-middle-slot-yJbunXPO"><input aria-describedby="" data-property-id="Risk/RewardlongEntryPrice" tabindex="-1" name="number-input" type="text" inputmode="numeric" class="input-oiYdY6I4 with-end-slot-oiYdY6I4" value="0.5162"></span><span class="inner-slot-yJbunXPO interactive-yJbunXPO"><div class="controlWrapper-I6SkDSuu"></div></span><span class="highlight-Mtq7m9Yl"></span></span></span></div></div></div></div><div class="cell-mTbR5jYu groupSeparator-mTbR5jYu fill-mTbR5jYu big-mTbR5jYu"></div><div data-section-name="Risk/RewardlongProfitLevel" class="cell-mTbR5jYu adaptive-mTbR5jYu checkableTitle-mTbR5jYu fill-mTbR5jYu"><div class="inner-mTbR5jYu titleWrap-IQolwY3b"><div class="wrap-CcYH2FIb title-IQolwY3b"><span class="title-mzBlcrjf">Profit level</span></div></div></div><div data-section-name="Risk/RewardlongProfitLevelTicks" class="cell-mTbR5jYu adaptive-mTbR5jYu checkableTitle-mTbR5jYu first-mTbR5jYu"><div class="inner-mTbR5jYu"><div class="wrap-CcYH2FIb"><span class="title-mzBlcrjf">Ticks</span></div></div></div><div data-section-name="Risk/RewardlongProfitLevelTicks" class="cell-mTbR5jYu"><div class="inner-mTbR5jYu"><div class="wrap-CcYH2FIb"><div class="wrap-CcYH2FIb wrap-e3mVhuS7 breakpointNormal-e3mVhuS7"><span class="row-e3mVhuS7"><span class="container-Mtq7m9Yl intent-default-Mtq7m9Yl border-thin-Mtq7m9Yl size-medium-Mtq7m9Yl adjust-position-Mtq7m9Yl first-row-Mtq7m9Yl first-col-Mtq7m9Yl font-size-medium-Mtq7m9Yl input-fWFHuxA3" tabindex="0"><span class="inner-slot-yJbunXPO inner-middle-slot-yJbunXPO"><input aria-describedby="" data-property-id="Risk/RewardlongProfitLevelTicks" tabindex="-1" name="number-input" type="text" inputmode="numeric" class="input-oiYdY6I4 with-end-slot-oiYdY6I4" value="91"></span><span class="inner-slot-yJbunXPO interactive-yJbunXPO"><div class="controlWrapper-I6SkDSuu"></div></span><span class="highlight-Mtq7m9Yl"></span></span></span></div></div></div></div><div data-section-name="Risk/RewardlongProfitLevelPrice" class="cell-mTbR5jYu adaptive-mTbR5jYu checkableTitle-mTbR5jYu first-mTbR5jYu"><div class="inner-mTbR5jYu"><div class="wrap-CcYH2FIb"><span class="title-mzBlcrjf">Price</span></div></div></div><div data-section-name="Risk/RewardlongProfitLevelPrice" class="cell-mTbR5jYu"><div class="inner-mTbR5jYu"><div class="wrap-CcYH2FIb"><div class="wrap-CcYH2FIb wrap-e3mVhuS7 breakpointNormal-e3mVhuS7"><span class="row-e3mVhuS7"><span class="container-Mtq7m9Yl intent-default-Mtq7m9Yl border-thin-Mtq7m9Yl size-medium-Mtq7m9Yl adjust-position-Mtq7m9Yl first-row-Mtq7m9Yl first-col-Mtq7m9Yl font-size-medium-Mtq7m9Yl input-fWFHuxA3" tabindex="0"><span class="inner-slot-yJbunXPO inner-middle-slot-yJbunXPO"><input aria-describedby="" data-property-id="Risk/RewardlongProfitLevelPrice" tabindex="-1" name="number-input" type="text" inputmode="numeric" class="input-oiYdY6I4 with-end-slot-oiYdY6I4" value="0.5553"></span><span class="inner-slot-yJbunXPO interactive-yJbunXPO"><div class="controlWrapper-I6SkDSuu"></div></span><span class="highlight-Mtq7m9Yl"></span></span></span></div></div></div></div><div class="cell-mTbR5jYu groupSeparator-mTbR5jYu fill-mTbR5jYu big-mTbR5jYu"></div><div data-section-name="Risk/RewardlongStopLevel" class="cell-mTbR5jYu adaptive-mTbR5jYu checkableTitle-mTbR5jYu fill-mTbR5jYu"><div class="inner-mTbR5jYu titleWrap-IQolwY3b"><div class="wrap-CcYH2FIb title-IQolwY3b"><span class="title-mzBlcrjf">Stop level</span></div></div></div><div data-section-name="Risk/RewardlongStopLevelTicks" class="cell-mTbR5jYu adaptive-mTbR5jYu checkableTitle-mTbR5jYu first-mTbR5jYu"><div class="inner-mTbR5jYu"><div class="wrap-CcYH2FIb"><span class="title-mzBlcrjf">Ticks</span></div></div></div><div data-section-name="Risk/RewardlongStopLevelTicks" class="cell-mTbR5jYu"><div class="inner-mTbR5jYu"><div class="wrap-CcYH2FIb"><div class="wrap-CcYH2FIb wrap-e3mVhuS7 breakpointNormal-e3mVhuS7"><span class="row-e3mVhuS7"><span class="container-Mtq7m9Yl intent-default-Mtq7m9Yl border-thin-Mtq7m9Yl size-medium-Mtq7m9Yl adjust-position-Mtq7m9Yl first-row-Mtq7m9Yl first-col-Mtq7m9Yl font-size-medium-Mtq7m9Yl input-fWFHuxA3" tabindex="0"><span class="inner-slot-yJbunXPO inner-middle-slot-yJbunXPO"><input aria-describedby="" data-property-id="Risk/RewardlongStopLevelTicks" tabindex="-1" name="number-input" type="text" inputmode="numeric" class="input-oiYdY6I4 with-end-slot-oiYdY6I4" value="91"></span><span class="inner-slot-yJbunXPO interactive-yJbunXPO"><div class="controlWrapper-I6SkDSuu"></div></span><span class="highlight-Mtq7m9Yl"></span></span></span></div></div></div></div><div data-section-name="Risk/RewardlongStopLevelPrice" class="cell-mTbR5jYu adaptive-mTbR5jYu checkableTitle-mTbR5jYu first-mTbR5jYu"><div class="inner-mTbR5jYu"><div class="wrap-CcYH2FIb"><span class="title-mzBlcrjf">Price</span></div></div></div><div data-section-name="Risk/RewardlongStopLevelPrice" class="cell-mTbR5jYu"><div class="inner-mTbR5jYu"><div class="wrap-CcYH2FIb"><div class="wrap-CcYH2FIb wrap-e3mVhuS7 breakpointNormal-e3mVhuS7"><span class="row-e3mVhuS7"><span class="container-Mtq7m9Yl intent-default-Mtq7m9Yl border-thin-Mtq7m9Yl size-medium-Mtq7m9Yl adjust-position-Mtq7m9Yl first-row-Mtq7m9Yl first-col-Mtq7m9Yl font-size-medium-Mtq7m9Yl input-fWFHuxA3" tabindex="0"><span class="inner-slot-yJbunXPO inner-middle-slot-yJbunXPO"><input aria-describedby="" data-property-id="Risk/RewardlongStopLevelPrice" tabindex="-1" name="number-input" type="text" inputmode="numeric" class="input-oiYdY6I4 with-end-slot-oiYdY6I4" value="0.5071"></span><span class="inner-slot-yJbunXPO interactive-yJbunXPO"><div class="controlWrapper-I6SkDSuu"></div></span><span class="highlight-Mtq7m9Yl"></span></span></span></div></div></div></div><div class="cell-mTbR5jYu groupSeparator-mTbR5jYu fill-mTbR5jYu big-mTbR5jYu"></div></div></div><div class="footer-PQhX1JKt"><span role="button" class="container-Mtq7m9Yl intent-default-Mtq7m9Yl border-thin-Mtq7m9Yl size-medium-Mtq7m9Yl adjust-position-Mtq7m9Yl first-row-Mtq7m9Yl first-col-Mtq7m9Yl button-nCHoYtuE themesButtonText-ugYgmubN" tabindex="0" data-role="listbox" aria-expanded="false"><span class="inner-slot-yJbunXPO inner-middle-slot-yJbunXPO"><span class="button-children-nCHoYtuE">Template</span></span><span class="inner-slot-yJbunXPO interactive-yJbunXPO"><span class="button-allnSfnt"><span class="icon-allnSfnt"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11 7" width="11" height="7" fill="none"><path stroke="currentColor" stroke-width="1.3" d="M.5 1.5l5 4 5-4"></path></svg></span></span></span><span class="highlight-Mtq7m9Yl"></span></span><div class="buttons-PQhX1JKt"><button name="cancel" class="button-OvB35Th_ size-small-OvB35Th_ color-brand-OvB35Th_ variant-secondary-OvB35Th_"><span class="content-OvB35Th_">Cancel</span></button><span class="submitButton-PQhX1JKt"><button name="submit" data-name="submit-button" class="button-OvB35Th_ size-small-OvB35Th_ color-brand-OvB35Th_ variant-primary-OvB35Th_"><span class="content-OvB35Th_">Ok</span></button></span></div></div></div></div><div style="position: fixed; z-index: 150; left: 0px; top: 0px;"></div></div></div></div>`;

let positionDiv = document.createElement("div");
positionDiv.innerHTML += positionContainer;

//DOM elements
const positionButton = document.querySelector(".position-button");
const priceButton = document.querySelector(".price-button");
const riskPercent = document.querySelector("#risk-percentage");
const positionAmount = document.querySelector("#position-amount");
const accountRisk = document.querySelector("#account-risk");

//display price elements
let entry = document.querySelector("#entry");
let target = document.querySelector("#target");
let stop = document.querySelector("#stop");
let profit = document.querySelector("#profit");
let loss = document.querySelector("#loss");

const prices = {
  risk: 10,
  entryPrice: 0,
  profitPrice: 0,
  stopPrice: 0,
  profit: 0,
  loss: 0,
  positionSize: 0,
  updatePrices: function () {
    entry.textContent = this.entryPrice;
    target.textContent = this.profitPrice;
    stop.textContent = this.stopPrice;
    profit.textContent = this.profit.toFixed(1);
    loss.textContent = this.loss.toFixed(1);
  },
  doCalculations: function () {
    let lossPercent = Math.abs(
      ((this.entryPrice - this.stopPrice) / this.entryPrice) * 100
    );

    let profitPercent = Math.abs(
      ((this.entryPrice - this.profitPrice) / this.entryPrice) * 100
    );

    lossPercent = lossPercent / 100;
    this.positionSize = this.risk / lossPercent;
    this.profit = this.positionSize + this.positionSize * (profitPercent / 100);
    this.loss = this.positionSize * (1 - lossPercent);
  },
};

//EVENTS
accountRisk.addEventListener("change", function (e) {
  prices.risk = e.target.value;
});

priceButton.addEventListener("click", function (e) {
  // price levels for entry, profit, stop
  var entryLevel = positionDiv.querySelector(
    '[data-property-id="Risk/RewardlongEntryPrice"]'
  );

  var profitLevel = positionDiv.querySelector(
    '[data-property-id="Risk/RewardlongProfitLevelPrice"]'
  );

  var stopLevel = positionDiv.querySelector(
    '[data-property-id="Risk/RewardlongStopLevelPrice"]'
  );

  prices.entryPrice = entryLevel.value;
  prices.profitPrice = profitLevel.value;
  prices.stopPrice = stopLevel.value;

  prices.doCalculations();
  prices.updatePrices();
});

positionButton.addEventListener("click", calculatePositionSize);

function calculatePositionSize(event) {
  let riskMultiplier = parseFloat(riskPercent.value) / 100;
  let calculatedAmount = prices.risk / riskMultiplier;
  positionAmount.value = calculatedAmount;
}
